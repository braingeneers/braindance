<!-- markdownlint-disable -->

<a href="https://github.com/braingeneers/braindance/blob/main/braindance/core/artifact_removal.py#L0"><img align="right" style={{"float":"right"}} src="https://img.shields.io/badge/-source-cccccc?style=flat-square" /></a>

# <kbd>module</kbd> `artifact_removal.py`




**Global Variables**
---------------
- **LOOKUP_TABLE**

---

<a href="https://github.com/braingeneers/braindance/blob/main/braindance/core/artifact_removal.py#L5"><img align="right" style={{"float":"right"}} src="https://img.shields.io/badge/-source-cccccc?style=flat-square" /></a>

## <kbd>function</kbd> `docstring_wrapper`

```python
docstring_wrapper(func)
```






---

<a href="https://github.com/braingeneers/braindance/blob/main/braindance/core/artifact_removal.py#L11"><img align="right" style={{"float":"right"}} src="https://img.shields.io/badge/-source-cccccc?style=flat-square" /></a>

## <kbd>function</kbd> `cubic_fit5`

```python
cubic_fit5(
    v,
    N=60,
    nc_start=60,
    mean_arr=None,
    mean_std=None,
    artifact_width=50,
    remove_frames_before=8
)
```

Perform cubic fitting on the input data. 



**Args:**
 
 - <b>`v`</b> (numpy.ndarray):  Input data array. 
 - <b>`N`</b> (int):  Window size for fitting. Default is 60. 
 - <b>`nc_start`</b> (int):  Starting point for fitting. Default is 60. 
 - <b>`mean_arr`</b> (numpy.ndarray, optional):  Array of mean values. Default is None. 
 - <b>`mean_std`</b> (float, optional):  Standard deviation of mean values. Default is None. 
 - <b>`artifact_width`</b> (int):  Width of artifact to remove. Default is 50. 
 - <b>`remove_frames_before`</b> (int):  Number of frames to remove before artifact. Default is 8. 



**Returns:**
 
 - <b>`tuple`</b>:  A tuple containing: 
        - v_cleaned (numpy.ndarray): Cleaned data array. 
        - art (numpy.ndarray): Artifact array. 


---

<a href="https://github.com/braingeneers/braindance/blob/main/braindance/core/artifact_removal.py#L33"><img align="right" style={{"float":"right"}} src="https://img.shields.io/badge/-source-cccccc?style=flat-square" /></a>

## <kbd>function</kbd> `mean_numba`

```python
mean_numba(a)
```

Compute mean of 2D array along axis 0 using Numba. 



**Args:**
 
 - <b>`a`</b> (numpy.ndarray):  Input 2D array. 



**Returns:**
 
 - <b>`numpy.ndarray`</b>:  Array of mean values. 


---

<a href="https://github.com/braingeneers/braindance/blob/main/braindance/core/artifact_removal.py#L51"><img align="right" style={{"float":"right"}} src="https://img.shields.io/badge/-source-cccccc?style=flat-square" /></a>

## <kbd>function</kbd> `cubic_fit2d`

```python
cubic_fit2d(
    data,
    N=60,
    nc_start=60,
    return_artifacts=False,
    artifact_width=50,
    remove_frames_before=8,
    n_stds=2
)
```

Perform 2D cubic fitting on the input data. 



**Args:**
 
 - <b>`data`</b> (numpy.ndarray):  Input 2D data array. 
 - <b>`N`</b> (int):  Window size for fitting. Default is 60. 
 - <b>`nc_start`</b> (int):  Starting point for fitting. Default is 60. 
 - <b>`return_artifacts`</b> (bool):  Whether to return artifacts. Default is False. 
 - <b>`artifact_width`</b> (int):  Width of artifact to remove. Default is 50. 
 - <b>`remove_frames_before`</b> (int):  Number of frames to remove before artifact. Default is 8. 
 - <b>`n_stds`</b> (int):  Number of standard deviations for threshold. Default is 2. 



**Returns:**
 
 - <b>`tuple`</b>:  A tuple containing: 
        - v_cleaned (numpy.ndarray): Cleaned 2D data array. 
        - art (numpy.ndarray or None): Artifact 2D array if return_artifacts is True, else None. 


---

<a href="https://github.com/braingeneers/braindance/blob/main/braindance/core/artifact_removal.py#L81"><img align="right" style={{"float":"right"}} src="https://img.shields.io/badge/-source-cccccc?style=flat-square" /></a>

## <kbd>function</kbd> `fast_factorial`

```python
fast_factorial(n)
```

Compute factorial using a lookup table for faster computation. 



**Args:**
 
 - <b>`n`</b> (int):  Input number. 



**Returns:**
 
 - <b>`int`</b>:  Factorial of n. 



**Raises:**
 
 - <b>`ValueError`</b>:  If n is greater than 20. 


---

<a href="https://github.com/braingeneers/braindance/blob/main/braindance/core/artifact_removal.py#L100"><img align="right" style={{"float":"right"}} src="https://img.shields.io/badge/-source-cccccc?style=flat-square" /></a>

## <kbd>function</kbd> `fast_median`

```python
fast_median(a)
```

Compute median of an array using Numba for faster computation. 



**Args:**
 
 - <b>`a`</b> (numpy.ndarray):  Input array. 



**Returns:**
 
 - <b>`float`</b>:  Median of the input array. 


---

<a href="https://github.com/braingeneers/braindance/blob/main/braindance/core/artifact_removal.py#L114"><img align="right" style={{"float":"right"}} src="https://img.shields.io/badge/-source-cccccc?style=flat-square" /></a>

## <kbd>function</kbd> `fast_mmean`

```python
fast_mmean(q, frame)
```

Compute moving mean. 



**Args:**
 
 - <b>`q`</b> (float):  Current moving mean. 
 - <b>`frame`</b> (float):  New value. 



**Returns:**
 
 - <b>`float`</b>:  Updated moving mean. 


---

## <kbd>class</kbd> `ArtifactRemoval`




<a href="https://github.com/braingeneers/braindance/blob/main/braindance/core/artifact_removal.py#L136"><img align="right" style={{"float":"right"}} src="https://img.shields.io/badge/-source-cccccc?style=flat-square" /></a>

### <kbd>function</kbd> `__init__`

```python
__init__(N, nc_start=0, min_val=-100, max_val=100, spike_thresh=[-3.5, -20])
```







---

#### <kbd>handler</kbd> shift_ind


---

<a href="https://github.com/braingeneers/braindance/blob/main/braindance/core/artifact_removal.py#L233"><img align="right" style={{"float":"right"}} src="https://img.shields.io/badge/-source-cccccc?style=flat-square" /></a>

### <kbd>function</kbd> `fit`

```python
fit(v, T, S)
```





---

<a href="https://github.com/braingeneers/braindance/blob/main/braindance/core/artifact_removal.py#L269"><img align="right" style={{"float":"right"}} src="https://img.shields.io/badge/-source-cccccc?style=flat-square" /></a>

### <kbd>function</kbd> `fit_step`

```python
fit_step(frame)
```

Recursively computes the new W then solves for the artifact of the center frame when the new frame is added 

---

<a href="https://github.com/braingeneers/braindance/blob/main/braindance/core/artifact_removal.py#L358"><img align="right" style={{"float":"right"}} src="https://img.shields.io/badge/-source-cccccc?style=flat-square" /></a>

### <kbd>function</kbd> `run`

```python
run(
    data,
    return_artifacts=False,
    return_spikes=False,
    progress_bar=False,
    n_workers=1
)
```

Runs the process for the whole data input. If data is a 1D array, it will return the cleaned data If data is a 2D array, it will run for each row 




---

_This file was automatically generated via [lazydocs](https://github.com/ml-tooling/lazydocs)._
