"use strict";(self.webpackChunkbraindance_docs=self.webpackChunkbraindance_docs||[]).push([[461],{6708:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>s,metadata:()=>l,toc:()=>a});var i=r(4848),t=r(8453);const s={sidebar_position:4},o="Training Your Own Detection Models",l={id:"RT-sort/usage/training-models",title:"Training Your Own Detection Models",description:"RT-Sort allows you to train your own detection models using leave-one-out cross-validation. Here's how to do it:",source:"@site/docs/RT-sort/usage/training-models.md",sourceDirName:"RT-sort/usage",slug:"/RT-sort/usage/training-models",permalink:"/brainloop/docs/RT-sort/usage/training-models",draft:!1,unlisted:!1,editUrl:"https://github.com/braingeneers/brainloop/docs/RT-sort/usage/training-models.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"Real-time Application (Online Use)",permalink:"/brainloop/docs/RT-sort/usage/real-time-application"},next:{title:"API Reference",permalink:"/brainloop/docs/RT-sort/api-reference"}},d={},a=[{value:"Training Detection Models",id:"training-detection-models",level:2},{value:"Parameters",id:"parameters",level:3},{value:"Recommended Parameters",id:"recommended-parameters",level:3},{value:"Returns",id:"returns",level:3},{value:"Sorting Recordings Offline with Kilosort2",id:"sorting-recordings-offline-with-kilosort2",level:2},{value:"Parameters",id:"parameters-1",level:3},{value:"Recommended Parameters",id:"recommended-parameters-1",level:3},{value:"Returns",id:"returns-1",level:3},{value:"Notes on Training",id:"notes-on-training",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"training-your-own-detection-models",children:"Training Your Own Detection Models"})}),"\n",(0,i.jsx)(n.p,{children:"RT-Sort allows you to train your own detection models using leave-one-out cross-validation. Here's how to do it:"}),"\n",(0,i.jsx)(n.h2,{id:"training-detection-models",children:"Training Detection Models"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"from braindance.core.spikedetector.train import train_detection_model\n\nmodel = train_detection_model(recordings)\n"})}),"\n",(0,i.jsx)(n.h3,{id:"parameters",children:"Parameters"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"recordings"}),": A list containing the recordings to use for training the detection model (at least two)."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"recommended-parameters",children:"Recommended Parameters"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"kilosort_path"}),': Folder where Kilosort2 is installed (if not set in environment variable "KILOSORT_PATH").']}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"input_scale"}),": Multiplier for recording traces before input into the detection model (default: 0.01)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"learning_rate"}),": Learning rate for training (default: 7.76e-4)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"validation_recording"}),": Recording to use as validation (default: None)."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"returns",children:"Returns"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ModelSpikeSorter"})," object"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"sorting-recordings-offline-with-kilosort2",children:"Sorting Recordings Offline with Kilosort2"}),"\n",(0,i.jsx)(n.p,{children:"If you prefer to sort recordings with Kilosort2 separately before training detection models, you can use:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"from braindance.core.spikesorter.kilosort2 import run_kilosort2\n\nrun_kilosort2(recording_files)\n"})}),"\n",(0,i.jsx)(n.h3,{id:"parameters-1",children:"Parameters"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"recordings"}),": A list containing the recordings to spike sort."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"recommended-parameters-1",children:"Recommended Parameters"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"kilosort_path"}),": Folder where Kilosort2 is installed."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"results_folders"}),": List of folders to store sorted results (default: None)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"compile_to_npz"}),': Whether to save results as "sorted.npz" (default: True).']}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"compile_to_mat"}),': Whether to save results as "sorted.mat" (default: False).']}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"intermediate_folders"}),": List of folders to store intermediate results (default: None)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"delete_inter"}),": Whether to delete intermediate folders after sorting (default: True)."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"returns-1",children:"Returns"}),"\n",(0,i.jsx)(n.p,{children:"None (results are saved to files)"}),"\n",(0,i.jsx)(n.h2,{id:"notes-on-training",children:"Notes on Training"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"The training process is divided into two main steps: spike sorting with Kilosort2 and training the detection model."}),"\n",(0,i.jsx)(n.li,{children:"Adjust the learning rate based on the loss curve created at the end of training."}),"\n",(0,i.jsx)(n.li,{children:"A straight loss curve might indicate a learning rate that is too low, while a curve that decreases initially but then strongly increases might indicate a rate that is too high."}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["For more details on parameters and advanced usage, refer to the ",(0,i.jsx)(n.a,{href:"../api-reference",children:"API Reference"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>l});var i=r(6540);const t={},s=i.createContext(t);function o(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);